<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Restless</title><meta name="robots" content="index,follow"/><meta name="description" content="undefined"/><meta property="og:title" content="Restless"/><meta property="og:description" content="undefined"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta property="og:image" content="https://og-image.vercel.app/Next.js%20Blog%20Starter%20Example.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><meta name="next-head-count" content="18"/><link rel="preload" href="https://jddunn.github.io/_next/static/css/102311681b07b408.css" as="style"/><link rel="stylesheet" href="https://jddunn.github.io/_next/static/css/102311681b07b408.css" data-n-g=""/><link rel="preload" href="https://jddunn.github.io/_next/static/css/3116167ddf16f948.css" as="style"/><link rel="stylesheet" href="https://jddunn.github.io/_next/static/css/3116167ddf16f948.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="https://jddunn.github.io/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="https://jddunn.github.io/_next/static/chunks/webpack-ce5f0ec9e7a9015e.js" defer=""></script><script src="https://jddunn.github.io/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="https://jddunn.github.io/_next/static/chunks/main-a028e25a41b5197e.js" defer=""></script><script src="https://jddunn.github.io/_next/static/chunks/pages/_app-f06f56473160e3e4.js" defer=""></script><script src="https://jddunn.github.io/_next/static/chunks/424-a679efd82258b30d.js" defer=""></script><script src="https://jddunn.github.io/_next/static/chunks/283-26f9239c83fd4f05.js" defer=""></script><script src="https://jddunn.github.io/_next/static/chunks/478-04308f6dd89c78fb.js" defer=""></script><script src="https://jddunn.github.io/_next/static/chunks/pages/projects/%5Bslug%5D-2b2fc9a6750ed450.js" defer=""></script><script src="https://jddunn.github.io/_next/static/7nfYsfP6W_HxPI4GB6HRY/_buildManifest.js" defer=""></script><script src="https://jddunn.github.io/_next/static/7nfYsfP6W_HxPI4GB6HRY/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="Navbar_navbar__VkIDk"><nav><section class="mobile-menu md:hidden"><div class="hamburger-icon space-y-2 mt-5 mr-5" style="cursor:pointer;position:fixed;top:0;right:0;margin:20"><span class="block h-0.5 w-8 animate-pulse bg-gray-600"></span><span class="block h-0.5 w-8 animate-pulse bg-gray-600"></span><span class="block h-0.5 w-8 animate-pulse bg-gray-600"></span></div><div class="hideMenuNav"><div class="absolute top-0 right-0 px-8 py-8" style="cursor:pointer"><svg class="h-8 w-8 text-gray-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="cursor:pointer"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></div><ul class="flex flex-col items-center justify-between min-h-[250px]"><a href="/"><li class="border-b border-gray-400 my-8 uppercase" style="margin-left:0px">HOME</li></a><a href="/about/"><li class="border-b border-gray-400 my-8 uppercase" style="margin-left:0px">ABOUT ME</li></a><a href="/projects/"><li class="border-b border-gray-400 my-8 uppercase" style="margin-left:0px">PROJECTS</li></a><a href="/open-source/"><li class="border-b border-gray-400 my-8 uppercase" style="margin-left:0px">OPEN SOURCE</li></a><a href="/blog/"><li class="border-b border-gray-400 my-8 uppercase" style="margin-left:0px">BLOG</li></a></ul></div></section><ul class="desktop-menu hidden md:flex"><a href="/"><li class="" style="margin-left:0px">__home</li></a><a href="/about/"><li class="" style="margin-left:0px">__about me</li></a><a href="/projects/"><li class="Navbar_active___L3RU" style="margin-left:0px">__projects</li></a><a href="/open-source/"><li class="" style="margin-left:0px">__open source</li></a><a href="/blog/"><li class="" style="margin-left:0px">__blog</li></a></ul></nav><style>
        .hideMenuNav {
          display: none;
        }
        .showMenuNav {
          display: block;
          position: absolute;
          width: 100%;
          min-height: 400px;
          top: 20;
          right: 20;
          z-index: 10;
          display: flex;
          flex-direction: column;
        }
        .mobile-menu ul {
          background-color: rgba(2, 10, 18, 0.95)
        }
    </style></div><div class="min-h-screen"><main><div class="container mx-auto px-5"><h2 class="text-1xl md:text-2xl lg:text-3xl font-bold tracking-tight  md:tracking-tighter leading-tight mb-20 mt-8"></h2><article class="mb-32"><div><h1 class="text-2xl md:text-2xl lg:text-3xl font-bold  tracking-tighter leading-tight md:leading-none mb-12  text-center"><span class="text-2xl md:text-2xl lg:text-3xl red-400 inline tracking-tighter leading-tight md:leading-none mb-12 text-center text-gray-400 mr-2">//</span>Restless</h1><div class="mb-0"><div class="text-md text-slate-500 text-center">Project created: <time dateTime="2020">2020</time></div><div class="text-md text-slate-200 mb-3 backButton"><button><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm3.5 7.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z"></path></svg></button></div></div><div class="text-md text-slate-500 text-center">Post updated: <time dateTime="2020">2020</time></div><div class="mb-8 md:mb-16 sm:mx-0 mt-5"><div class="sm:mx-0"><div class="relative mx-auto"><img alt="Cover Image for Restless" loading="lazy" width="600" height="480" decoding="async" data-nimg="1" class="shadow-lg dark:shadow-black/30 mx-auto" style="color:transparent" src="/assets/projects/restless-transparent-logo.png"/></div></div><div class="text-sm text-slate-500 mb-4 mt-2 text-center"><span class="mr-5 underline">python</span><span class="mr-5 underline">ai</span><span class="mr-5 underline">security</span><span class="mr-5 underline">malware</span><span class="mr-5 underline">nlp</span></div></div><div class="max-w-2xl mx-auto"></div></div><div class="max-w-2xl mx-auto"><div class="markdown-styles_markdown__9bgXN"><p><a href="https://github.com/jddunn/restless" style="text-align: center" target="_blank" class="md-link">GitHub link</a></p>
<h2 id="intro">Intro</h2>
<p>Restless is meant to be a suite of security tools with these key features:</p>
<ul>
<li>Analysis of files for malware probabilty based on comparing the extracted metadata and file contents with trained Portable Executable data (completed model with around 20 extracted PE header features with ~93% average accuracy in cross-validation training)</li>
<li>Analysis of system logs for abnormal activities / deviations (not started)</li>
<li>Constant, efficient and ongoing analysis of system files / logs (in-progress)</li>
</ul>
<p><a href="/assets/projects/Restless%20-%20CLI%20Full%20Scan%20Demo.gif" target="_blank"><img src="/assets/projects/Restless%20-%20CLI%20Full%20Scan%20Demo.gif" class="img-shadow" style="display: block; margin-left: auto; margin-right: auto;" width="700" alt="Restless CLI functionality running to scan malware"></img></a>
<span style="text-align: center; color: grey; margin-left: auto; margin-right: auto; display: block; width: 80%">Restless comes with a super sweet CLI.</span></p>
<p>Restless aims to be fast and fully functional offline. The current Docker config is for Ubuntu-based machines, but can be modified for other platforms by editing the Dockerfile and docker-compose.yml (eventually, Docker images will be built for Mac and Windows and linked here for download).</p>
<h2 id="concepts">Concepts</h2>
<p>Signature detection, the traditional method of antiviruses which creates the need to connect to online databases for incessant updating, cannot keep up with the emergence of new malware, or even of known malware that's able to change itself, and while heuristics-based approaches can combat polymorphic viruses while offering further degrees of granularity, they tend to give off so many false positives that they do more harm than good by wasting computing resources and increasing cognitive load.</p>
<p>The incorporation of machine learning (usually, natural language processing techniques although computer vision algorithms can also be applied) in antivirus software empowers them with a level of pattern recognition that previous approaches do not have. Rather than relying on known vulnerabilities / exploits or commonly re-used patterns of malicious code, restless and other ML-powered antiviruses can work well on classifying malware never seen before. This integration of NLP methods with information security has been dubbed malicious language processing by Elastic.</p>
<h2 id="architecture">Architecture</h2>
<ul>
<li><p>Hierarchical attention network (LSTM) for binary classification (benign vs malicious) of EXE files via extracting PE metadata and strings from file contents (including obfuscated strings). The HANN model is perfect as it retains some element of document structure, which is important when analyzing file contents and looking for potentially destructive patterns in code.</p></li>
<li><p>HANN trained for system API calls for benign vs malicious binary classification of logs (planned)</p></li>
<li><p>K-means clustering for learning unsupervised patterns of abnormal / deviant logs (planned) ..</p></li>
</ul>
<p>Restless's current classifications are implemented through a <a class="md-link" href="https://www.cs.cmu.edu/~./hovy/papers/16HLT-hierarchical-attention-networks.pdf" target="_blank" style="margin-left: 0; margin-right: 0; display: inline">hierarchical attention network,</a> a type of recurrent neural network with an attention layer that can find the most important words and sentences to represent a document, as it is able to read the data in a bidirectional way to learn context.</p>
<p>The architecture from the paper has been modified in Restless's implementation of HAN, in that a vector (array of features) is now acceptable (as well as scalars) for both "sentences" and "words" that build up the vocabulary.</p>
<p>This allows us to represent any arbitrary set of features as a document that the HAN model can learn from, as GloVe (the pre-trained word embeddings) has weights for words as well as numbers. For example, in a word embeddings model like GloVe that considers numbers, a number like 8069 will have contextual meaning (as 8069 would be referenced a lot in computing-related documents).</p>
<p>Typically a document would be tokenized into sentences and then into words to fit the format the HAN model needs, but we can construct a representation of a document that corresponds to the metadata of our file. By extracting PE features like CheckSum, AddressOfEntryPoint, e_minalloc, and more, and considering each feature as a sentence, we can create a HAN classifier that reads executable files and their metadata like documents, and make use of the attention layer so it understands which features have more contextual importance than others.</p>
<p>Originally, Restless's classifier was going to extract strings (including obfuscated strings) from file contents of known malicious and benign files, and then build document representations from that dataset using the hierarchical attention neural network. However, collecting a dataset of executables (from trustworthy sources) is proving to be very time-consuming, so the current focus will focus on the file metadata representation construction.</p>
<h2 id="researchresults">Research &amp; Results</h2>
<p>I did some basic feature selection using Pearson coefficient to see how our features correlate with each other, and since we're doing binary classification, we can get the point-biserial correlation for each feature compared to our target feature (classification of "benign" or "malicious").</p>
<p>Unlike conventional feature selection for regression, our model (HANN) takes a representation of documents as features (features ~= document sentences in this context). For HANN, we care about any feature that has some linear correlation, positive or negative.</p>
<p><a href="/assets/projects/Features Correlation Matrix for PE Header Data.png" target="_blank"><img src="/assets/projects/Features Correlation Matrix for PE Header Data.png" class="img-shadow" style="display: block; margin-left: auto; margin-right: auto;" width="500" alt="Features Correlation Matrix for PE Header Dat"></img></a>
<span style="text-align: center; color: grey; margin-left: auto; margin-right: auto; display: block; width: 80%">Features Correlation Matrix for PE Header Data.</span></p>
<p><a href="/assets/projects/Top Features Correlation Matrix for PE Header Data (Minimum threshold of 0.1).png" target="_blank"><img src="/assets/projects/Top Features Correlation Matrix for PE Header Data (Minimum threshold of 0.1).png" class="img-shadow" style="display: block; margin-left: auto; margin-right: auto;" width="500" alt="Top Features Correlation Matrix for PE Header Data (Minimum threshold of 0.1)"></img></a>
<span style="text-align: center; color: grey; margin-left: auto; margin-right: auto; display: block; width: 80%">Top Features Correlation Matrix for PE Header Data (Minimum threshold of 0.1).</span></p>
<h3 id="traininghierarchicalattentionnetworkmodel">Training Hierarchical Attention Network Model</h3>
<p>(With top extracted PE features correlated with class target, and 5KFold validation)</p>
<pre><code>cd restless/components/nlp/hann
python train_hann.py
Training HANN model now..
Creating HANN model now, with K-Fold cross-validation. K= 1 
    and length:  4147 1037 for training / validation.
Train on 4147 samples, validate on 1037 samples
Epoch 1/3
 - 123s - loss: 0.6237 - accuracy: 0.6173 - val_loss: 0.4314 
        - val_accuracy: 0.8023
Epoch 2/3
 - 121s - loss: 0.3515 - accuracy: 0.8560 - val_loss: 0.3218 
        - val_accuracy: 0.8804
Epoch 3/3
 - 120s - loss: 0.2588 - accuracy: 0.9079 - val_loss: 0.2703
        - val_accuracy: 0.8939
..
Metrics summed and averaged:  {'accuracy': 0.9328727060163897,
     'loss': 2.3185255947187513, 'precision': 0.9461413757441932,
     'recall': 0.9280079306100244, 'f1': 0.9356620828481846,
     'kappa': 0.8656351205984505, 'auc': 0.9351519030411508}
The best performing model (based on F1 score) was number 3. That
    is the model that will be returned.
Training successful.
Saving model to /home/ubuntu/restless/restless/data/models/default.h5.
</code></pre>
<p><b>Stats of our best performing model (highest F1 score):</b></p>
<pre><code>Model evaluation metrics: 

        Confusion matrix: 
                 benign malicious 
       benign     446.0      66.0 
    malicious       3.0     522.0 
         None
        Accuracy: 0.9334619093539055    Loss: 2.298195125052296
        Precision: 0.9942857142857143
        Recall: 0.8877551020408163
        F1 score: 0.9380053908355795
        Cohens kappa score: 0.8666998273038725
        ROC AUC score: 0.9405367937821009
</code></pre>
<h2 id="credits">Credits</h2>
<ul>
<li>Malicious executables obtained from http://www.tekdefense.com/downloads/malware-samples/. </li>
<li>Training dataset taken from https://github.com/urwithajit9/ClaMP.</li>
</ul></div></div></article></div></main></div><div class="Footer_footer__BH5s_"><div><p class="Footer_find__pDm3T" style="letter-spacing:2px">find me on:</p><a href="https://www.linkedin.com/in/jdfive/" target="_blank" rel="noopener noreferrer"><span class="Footer_footerIcon__bo_UL"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"></path></svg></span></a><a href="https://github.com/jddunn" target="_blank" rel="noopener noreferrer"><span class="Footer_footerIcon__bo_UL"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg></span></a></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Restless","date":"2020","createdDate":"2020","slug":"restless","tags":"python,ai,security,malware,nlp","content":"\u003ca href=\"https://github.com/jddunn/restless\" style=\"text-align: center\" target=\"_blank\" class=\"md-link\"\u003eGitHub link\u003c/a\u003e\n\n## Intro\n\nRestless is meant to be a suite of security tools with these key features:\n\n- Analysis of files for malware probabilty based on comparing the extracted metadata and file contents with trained Portable Executable data (completed model with around 20 extracted PE header features with ~93% average accuracy in cross-validation training)\n- Analysis of system logs for abnormal activities / deviations (not started)\n- Constant, efficient and ongoing analysis of system files / logs (in-progress)\n\n\u003ca href=\"/assets/projects/Restless%20-%20CLI%20Full%20Scan%20Demo.gif\" target=\"_blank\"\u003e\u003cimg src=\"/assets/projects/Restless%20-%20CLI%20Full%20Scan%20Demo.gif\" class=\"img-shadow\" style=\"display: block; margin-left: auto; margin-right: auto;\" width=\"700\" alt=\"Restless CLI functionality running to scan malware\"\u003e\u003c/img\u003e\u003c/a\u003e\n\u003cspan style=\"text-align: center; color: grey; margin-left: auto; margin-right: auto; display: block; width: 80%\"\u003eRestless comes with a super sweet CLI.\u003c/span\u003e\n\nRestless aims to be fast and fully functional offline. The current Docker config is for Ubuntu-based machines, but can be modified for other platforms by editing the Dockerfile and docker-compose.yml (eventually, Docker images will be built for Mac and Windows and linked here for download).\n\n## Concepts\n\nSignature detection, the traditional method of antiviruses which creates the need to connect to online databases for incessant updating, cannot keep up with the emergence of new malware, or even of known malware that's able to change itself, and while heuristics-based approaches can combat polymorphic viruses while offering further degrees of granularity, they tend to give off so many false positives that they do more harm than good by wasting computing resources and increasing cognitive load.\n\nThe incorporation of machine learning (usually, natural language processing techniques although computer vision algorithms can also be applied) in antivirus software empowers them with a level of pattern recognition that previous approaches do not have. Rather than relying on known vulnerabilities / exploits or commonly re-used patterns of malicious code, restless and other ML-powered antiviruses can work well on classifying malware never seen before. This integration of NLP methods with information security has been dubbed malicious language processing by Elastic.\n\n## Architecture\n\n- Hierarchical attention network (LSTM) for binary classification (benign vs malicious) of EXE files via extracting PE metadata and strings from file contents (including obfuscated strings). The HANN model is perfect as it retains some element of document structure, which is important when analyzing file contents and looking for potentially destructive patterns in code.\n\n- HANN trained for system API calls for benign vs malicious binary classification of logs (planned)\n\n- K-means clustering for learning unsupervised patterns of abnormal / deviant logs (planned) ..\n\nRestless's current classifications are implemented through a \u003ca class=\"md-link\" href=\"https://www.cs.cmu.edu/~./hovy/papers/16HLT-hierarchical-attention-networks.pdf\" target=\"_blank\" style=\"margin-left: 0; margin-right: 0; display: inline\"\u003ehierarchical attention network,\u003c/a\u003e a type of recurrent neural network with an attention layer that can find the most important words and sentences to represent a document, as it is able to read the data in a bidirectional way to learn context.\n\nThe architecture from the paper has been modified in Restless's implementation of HAN, in that a vector (array of features) is now acceptable (as well as scalars) for both \"sentences\" and \"words\" that build up the vocabulary.\n\nThis allows us to represent any arbitrary set of features as a document that the HAN model can learn from, as GloVe (the pre-trained word embeddings) has weights for words as well as numbers. For example, in a word embeddings model like GloVe that considers numbers, a number like 8069 will have contextual meaning (as 8069 would be referenced a lot in computing-related documents).\n\nTypically a document would be tokenized into sentences and then into words to fit the format the HAN model needs, but we can construct a representation of a document that corresponds to the metadata of our file. By extracting PE features like CheckSum, AddressOfEntryPoint, e_minalloc, and more, and considering each feature as a sentence, we can create a HAN classifier that reads executable files and their metadata like documents, and make use of the attention layer so it understands which features have more contextual importance than others.\n\nOriginally, Restless's classifier was going to extract strings (including obfuscated strings) from file contents of known malicious and benign files, and then build document representations from that dataset using the hierarchical attention neural network. However, collecting a dataset of executables (from trustworthy sources) is proving to be very time-consuming, so the current focus will focus on the file metadata representation construction.\n\n## Research \u0026 Results\n\nI did some basic feature selection using Pearson coefficient to see how our features correlate with each other, and since we're doing binary classification, we can get the point-biserial correlation for each feature compared to our target feature (classification of \"benign\" or \"malicious\").\n\nUnlike conventional feature selection for regression, our model (HANN) takes a representation of documents as features (features ~= document sentences in this context). For HANN, we care about any feature that has some linear correlation, positive or negative.\n\n\u003ca href=\"/assets/projects/Features Correlation Matrix for PE Header Data.png\" target=\"_blank\"\u003e\u003cimg src=\"/assets/projects/Features Correlation Matrix for PE Header Data.png\" class=\"img-shadow\" style=\"display: block; margin-left: auto; margin-right: auto;\" width=\"500\" alt=\"Features Correlation Matrix for PE Header Dat\"\u003e\u003c/img\u003e\u003c/a\u003e\n\u003cspan style=\"text-align: center; color: grey; margin-left: auto; margin-right: auto; display: block; width: 80%\"\u003eFeatures Correlation Matrix for PE Header Data.\u003c/span\u003e\n\n\u003ca href=\"/assets/projects/Top Features Correlation Matrix for PE Header Data (Minimum threshold of 0.1).png\" target=\"_blank\"\u003e\u003cimg src=\"/assets/projects/Top Features Correlation Matrix for PE Header Data (Minimum threshold of 0.1).png\" class=\"img-shadow\" style=\"display: block; margin-left: auto; margin-right: auto;\" width=\"500\" alt=\"Top Features Correlation Matrix for PE Header Data (Minimum threshold of 0.1)\"\u003e\u003c/img\u003e\u003c/a\u003e\n\u003cspan style=\"text-align: center; color: grey; margin-left: auto; margin-right: auto; display: block; width: 80%\"\u003eTop Features Correlation Matrix for PE Header Data (Minimum threshold of 0.1).\u003c/span\u003e\n\n### Training Hierarchical Attention Network Model\n(With top extracted PE features correlated with class target, and 5KFold validation)\n\n```\ncd restless/components/nlp/hann\npython train_hann.py\nTraining HANN model now..\nCreating HANN model now, with K-Fold cross-validation. K= 1 \n    and length:  4147 1037 for training / validation.\nTrain on 4147 samples, validate on 1037 samples\nEpoch 1/3\n - 123s - loss: 0.6237 - accuracy: 0.6173 - val_loss: 0.4314 \n        - val_accuracy: 0.8023\nEpoch 2/3\n - 121s - loss: 0.3515 - accuracy: 0.8560 - val_loss: 0.3218 \n        - val_accuracy: 0.8804\nEpoch 3/3\n - 120s - loss: 0.2588 - accuracy: 0.9079 - val_loss: 0.2703\n        - val_accuracy: 0.8939\n..\nMetrics summed and averaged:  {'accuracy': 0.9328727060163897,\n     'loss': 2.3185255947187513, 'precision': 0.9461413757441932,\n     'recall': 0.9280079306100244, 'f1': 0.9356620828481846,\n     'kappa': 0.8656351205984505, 'auc': 0.9351519030411508}\nThe best performing model (based on F1 score) was number 3. That\n    is the model that will be returned.\nTraining successful.\nSaving model to /home/ubuntu/restless/restless/data/models/default.h5.\n```\n\n\u003cb\u003eStats of our best performing model (highest F1 score):\u003c/b\u003e\n\n```\nModel evaluation metrics: \n\n        Confusion matrix: \n                 benign malicious \n       benign     446.0      66.0 \n    malicious       3.0     522.0 \n         None\n        Accuracy: 0.9334619093539055    Loss: 2.298195125052296\n        Precision: 0.9942857142857143\n        Recall: 0.8877551020408163\n        F1 score: 0.9380053908355795\n        Cohens kappa score: 0.8666998273038725\n        ROC AUC score: 0.9405367937821009\n```\n\n## Credits\n\n- Malicious executables obtained from http://www.tekdefense.com/downloads/malware-samples/. \n- Training dataset taken from https://github.com/urwithajit9/ClaMP.","ogImage":{"url":"/assets/projects/restless-transparent-logo.png"},"coverImage":"/assets/projects/restless-transparent-logo.png"}},"__N_SSG":true},"page":"/projects/[slug]","query":{"slug":"restless"},"buildId":"7nfYsfP6W_HxPI4GB6HRY","assetPrefix":"https://jddunn.github.io","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>